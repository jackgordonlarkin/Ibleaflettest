
<!DOCTYPE html>
<html lang="en">
<head>
 
     <!-- Load Leaflet from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" crossorigin=""></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@3.0.10/dist/esri-leaflet.js"></script>
    <script src="https://unpkg.com/esri-leaflet-vector@4.0.0/dist/esri-leaflet-vector.js"></script>
    <script src="leaflet-zoom-show-hide.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>    <meta http-equiv="X-UA-Compatible" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content= "Jack Larkin">
    <title>Map testing</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/stylish-portfolio.css" rel="stylesheet">
    <script src = "papaparse.min.js"></script>
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>Zoomy Map</title>
    <style>
      html,
      body,
      #map {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 14px;
        color: #323232;
       z-index: 0
      }
        #menu {
position: fixed;
background: rgba(255, 255, 255, 0.5);
padding: 2px;
top: 3.5%;
left: 0;
width: 422px;
z-index: 111;
}
          #basemaps-wrapper {
        position: absolute;
        top: 20px;
        left: 20px;
        background: rgba(255, 255, 255, 0);
      }
      #basemaps {
        font-size: 16px;
        padding: 4px 8px;
      }
    </style>
<script src=https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.js></script>
    <link href=https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.css rel="stylesheet" />
<script src ="https://unpkg.com/mapbox-gl-esri-sources/dist/mapbox-gl-esri-services"></script>
  </head>

  <body>
<a id="menu-toggle" href="#" class="btn btn-dark btn-lg toggle"><i class="fa fa-bars"></i></a>
    <nav id="sidebar-wrapper">
        <ul class="sidebar-nav">
            <a id="menu-close" href="#" class="btn btn-light btn-lg pull-right toggle"><i class="fa fa-times"></i></a>
            <li class="sidebar-brand">
                <a href="#top" onclick=$("#menu-close").click();><b>Map Test</b></a>
            </li>
            <li>
                <b><a href="index.html" onclick=$("#menu-close").click();>Zooming through layers</a></b>
            </li>
            <li>
                <a href="#map" onclick=$("#menu-close").click();>Transparency</a>
            </li>
           
        </ul>
    </nav>
<div id="map"></div>
          <div id="basemaps-wrapper">

      <select id="basemaps">
        <option value="ArcGIS:Community">Community</option>
        <option value="ArcGIS:Streets">Streets</option>
        <option value="ArcGIS:Navigation">Navigation</option>
        <option value="ArcGIS:Topographic">Topographic</option>
        <option value="ArcGIS:LightGray">Light Gray</option>
        <option value="ArcGIS:DarkGray">Dark gray</option>
        <option value="ArcGIS:StreetsRelief">Streets Relief</option>
        <option value="ArcGIS:Imagery:Standard">Imagery</option>
        <option value="ArcGIS:ChartedTerritory">ChartedTerritory</option>
        <option value="ArcGIS:ColoredPencil">ColoredPencil</option>
        <option value="ArcGIS:Nova">Nova</option>
        <option value="ArcGIS:Midcentury">Midcentury</option>
        <option value="OSM:Standard">OSM</option>
        <option value="OSM:Streets">OSM:Streets</option>
      </select>

    </div>
    <script>

     const apiKey = "AAPK01d3c973b91841e99191a7cb96374713ppA1XdSa_FzdBTpO68P75mXoB6ZHH8JMoore66SKKVDlcN39rMGtvZS59A1c8rEU";

// Get the basemaps dropdown element
const basemapsDropdown = document.getElementById('basemaps');

// Add an event listener to the basemaps dropdown
basemapsDropdown.addEventListener('change', () => {
  // Get the selected basemap value
  const basemapEnum = basemapsDropdown.value;
  
  // Update the map style with the selected basemap
  map.setStyle(`https://basemaps-api.arcgis.com/arcgis/rest/services/styles/${basemapEnum}?type=style&token=${apiKey}`);
 
  map.once("styledata", () => {
  // This code runs once the base style has finished loading.

  map.addSource("hillshade", {
    type: "raster",
    tiles: [
      "https://maps.six.nsw.gov.au/arcgis/rest/services/public/NSW_Topo_Map/MapServer/tile/{z}/{y}/{x}"],
    tileSize : 100
  });

  // Find the first non-background layer in order to add our raster layer before it.
  const layers = map.getStyle().layers;
  const bottomLayer = layers.find((layer) => layer.type !== "background");

  map.addLayer(
    {
      id: "hillshade-raster",
      type: "raster",
      source: "hillshade"
    },

    bottomLayer.id

  );

  layers.forEach((layer) => {
    if (layer.type === "fill" && !layer.id.match(/(Marine area)/)) {
      map.setPaintProperty(layer.id, "fill-opacity", 0.2);
    }
  });
    

});
 
});

// Create the map with the initial basemap
let basemapEnum = basemapsDropdown.value;
const map = new maplibregl.Map({
  container: "map", // the id of the div element
  style: `https://basemaps-api.arcgis.com/arcgis/rest/services/styles/${basemapEnum}?type=style&token=${apiKey}`,
  zoom: 12, // starting zoom
  center: [149.131,-35.27] // starting location [longitude, latitude]
});

// Add navigation control to the map
map.addControl(
  new maplibregl.NavigationControl({
    visualizePitch: true,
    showZoom: true,
    showCompass: true
  })
);

// Add hillshade layer to the map
map.once("styledata", () => {
  // This code runs once the base style has finished loading.

  map.addSource("hillshade", {
    type: "raster",
    tiles: [
      "https://maps.six.nsw.gov.au/arcgis/rest/services/public/NSW_Topo_Map/MapServer/tile/{z}/{y}/{x}"],
    tileSize : 100
  });

  // Find the first non-background layer in order to add our raster layer before it.
  const layers = map.getStyle().layers;
  const bottomLayer = layers.find((layer) => layer.type !== "background");

  map.addLayer(
    {
      id: "hillshade-raster",
      type: "raster",
      source: "hillshade"
    },

    bottomLayer.id

  );

  layers.forEach((layer) => {
    if (layer.type === "fill" && !layer.id.match(/(Marine area)/)) {
      map.setPaintProperty(layer.id, "fill-opacity", 0.2);
    }
  });
    

});



    </script>
    
  </body>

</html>