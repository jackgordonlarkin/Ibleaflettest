<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>MapLibre GL JS Tutorials: Display a map</title>
    <style>
      html,
      body,
      #map {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 14px;
        color: #323232;
      }
    </style>
<script src=https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.js></script>
    <link href=https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.css rel="stylesheet" />
<script src ="https://unpkg.com/mapbox-gl-esri-sources/dist/mapbox-gl-esri-services"></script>
  </head>

  <body>
    
  </body>

</html>
<div id="map"></div>
    <script>

      const apiKey = "AAPK01d3c973b91841e99191a7cb96374713ppA1XdSa_FzdBTpO68P75mXoB6ZHH8JMoore66SKKVDlcN39rMGtvZS59A1c8rEU";
      const basemapEnum = "ArcGIS:Community";
      const map = new maplibregl.Map({
        container: "map", // the id of the div element
        style: `https://basemaps-api.arcgis.com/arcgis/rest/services/styles/${basemapEnum}?type=style&token=${apiKey}`,
        zoom: 12, // starting zoom
        center: [149.131,-35.27] // starting location [longitude, latitude]
      });
map.addControl(
new maplibregl.NavigationControl({
visualizePitch: true,
showZoom: true,
showCompass: true
})
);
      map.once("load", () => {
        // This code runs once the base style has finished loading.

        map.addSource("hillshade", {
          type: "raster",
          tiles: [
            "https://maps.six.nsw.gov.au/arcgis/rest/services/public/NSW_Topo_Map/MapServer/tile/{z}/{y}/{x}"],
          tileSize : 100
        });

        // Find the first non-background layer in order to add our raster layer before it.
        const layers = map.getStyle().layers;
        const bottomLayer = layers.find((layer) => layer.type !== "background");

        map.addLayer(
          {
            id: "hillshade-raster",
            type: "raster",
            source: "hillshade"
          },

          bottomLayer.id

        );

        layers.forEach((layer) => {
          if (layer.type === "fill" && !layer.id.match(/(Marine area)/)) {
            map.setPaintProperty(layer.id, "fill-opacity", 0.2);
          }
        });

      });

    </script>
